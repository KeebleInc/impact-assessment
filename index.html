<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>Take Home Test from Impact</title>
  <link href="styles.css" rel="stylesheet" type="text/css" />
  
                  <style>
              .myButton {
                border: 5px solid #000000;
                border-radius: 12px;
                background: #FF0000;
                color: #FFFFFF;
                display:inline-block;
                padding:20px;
                opacity:1;
              }
              .myButton:hover {
                opacity:0.5;
              }
                  </style>
                
</head>
<body>
 
  <script>
    // Function to get query string parameters
    function getParameterByName(name, url) {
      if (!url) url = window.location.href;
      name = name.replace(/[\[\]]/g, '\\$&');
      var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
          results = regex.exec(url);
      if (!results) return null;
      if (!results[2]) return '';
      return decodeURIComponent(results[2].replace(/\+/g, ' '));
    }

    // Push query string parameters to the data layer
    var key = getParameterByName('key');
    var value = getParameterByName('value');
    if (key && value) {
      window.dataLayer = window.dataLayer || [];
      window.dataLayer.push({
        'queryKey': key,
        'queryValue': value
      });
    }
  </script>
  
  <!-- Google Tag Manager (GTM) -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-PG98WLVP');</script>
  <!-- End Google Tag Manager -->
  
  <div class="container">
    <header>
      <h1>Technical Assessment Overview</h1>
    </header>
    <section>
      <h2>1. Google Tag Manager</h2>
      <p>Implement a GTM on your website site and load your website with the following query string parameter: <code>?key=hello&value=world</code></p>
      <p>Add functionality to push the key value pair to the GTM data layer. Also, ensure that these values are not hardcoded, allowing testing of other key value pairs.</p>
      <a class="myButton" href="https://keebleinc.github.io/impact-assessment/?key=hello&value=world">Click Me To Test The GTM</a>
      <a class="myButton" href="https://keebleinc.github.io/impact-assessment/?key=impact&value=assessment">Click Me To Test Another Key Value Pair</a>
    </section>

    <section>
      <h2>2. API Implementation</h2>
      <p>Add a button to your page that sends a GET API request using <a href="http://httpbin.org/" target="_blank">http://httpbin.org/</a>. The API call should use the query string parameters stored in the GTM data layer (from task 1) as key-value pairs sent to the GET request.</p>
      <p>Log the response in the console.</p>
    </section>
  <button id="apiRequestButton">Send API Request</button>

<script>
document.getElementById("apiRequestButton").addEventListener("click", function() {
    // Retrieve data from the GTM data layer
    var gtmData = window.dataLayer[0]; // Assuming the data is stored in the first element of the data layer
    
    // Construct the query string parameters
    var queryString = '';
    for (var key in gtmData) {
        if (gtmData.hasOwnProperty(key)) {
            if (queryString !== '') {
                queryString += '&';
            }
            queryString += encodeURIComponent(key) + '=' + encodeURIComponent(gtmData[key]);
        }
    }
    
    // Construct the API URL with the query string parameters
    var apiUrl = 'https://httpbin.org/get?' + queryString;
    
    // Send the GET request
    fetch(apiUrl)
        .then(response => response.json())
        .then(data => {
            console.log("Response:", data);
        })
        .catch(error => {
            console.error("Error:", error);
        });
});
</script>

   <section>
      <h2>3. User Flow Diagram</h2>
      <iframe style="border: 1px solid rgba(0, 0, 0, 0.1);" width="800" height="450" src="https://www.figma.com/embed?embed_host=share&url=https%3A%2F%2Fwww.figma.com%2Ffile%2FcTh4as0VVLGZ9r6JcE2HbG%2FUser-Flow-Diagram-Template-for-FigJam-(Community)%3Ftype%3Dwhiteboard%26node-id%3D0%253A1%26t%3D2gGjdMtl8Eh3Chs5-1" allowfullscreen></iframe>
    </section>
    
  </div>
</body>
</html>
